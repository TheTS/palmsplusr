<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A complete example • palmsplusr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">palmsplusr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="../articles/article-1-getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/article-1-getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/article-2-complete-example.html">A complete example</a>
    </li>
    <li>
      <a href="../articles/article-3-building-formulas.html">Building formulas</a>
    </li>
    <li>
      <a href="../articles/article-4-ggplot2-palmsplusr.html">ggplot2 and palmsplusr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="http://github.com/TheTS/palmsplusr/">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>A complete example</h1>
            
            <h4 class="date">2018-01-12</h4>
          </div>

    
    
<div class="contents">
<p>This article will demonstrate a real world example with a 191-participant dataset.</p>
<div id="reading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-data" class="anchor"></a>Reading data</h2>
<p>All data should be loaded at the beginning of the script. This includes the PALMS dataset, and any other shapefiles and csv files. Any preprocessing, such as buffering can also be done here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(palmsplusr)
<span class="kw">library</span>(readr)

<span class="co"># Load PALMS dataset</span>
palms &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_palms.html">read_palms</a></span>(<span class="st">"F:/data/csv/palms_output.csv"</span>)

<span class="co"># Load other csvs</span>
participant_basis &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"F:/data/csv/participant_basis.csv"</span>)
class_timetable &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"F:/data/csv/class_timetable.csv"</span>)

<span class="co"># Load shapefiles (home points &amp; schoolyard polygons)</span>
home &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">"F:/data/shapefiles/home.shp"</span>)
school &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">"F:/data/shapefiles/school.shp"</span>)

<span class="co"># Buffer home points</span>
home.buffer &lt;-<span class="st"> </span><span class="kw"><a href="../reference/palms_buffer.html">palms_buffer</a></span>(<span class="dt">point =</span> home, <span class="dt">distance =</span> <span class="dv">100</span>, <span class="dt">crs =</span> <span class="dv">2193</span>)</code></pre></div>
<p>The participant_basis file is used to link participant identifier with the correct school and classroom:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(participant_basis, <span class="dt">n =</span> <span class="dv">5</span>)
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   identifier school_id class_id</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;int&gt;    &lt;int&gt;</span>
<span class="co">#&gt; 1 RC0400             2        2</span>
<span class="co">#&gt; 2 RC0402             2        2</span>
<span class="co">#&gt; 3 RC0404             2        2</span>
<span class="co">#&gt; 4 RC0406             2        2</span>
<span class="co">#&gt; 5 RC0414             2        2</span></code></pre></div>
<p>The class_timetable file details start and end times for school and recess preiods, for each school/classroom:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(class_timetable, <span class="dt">n =</span> <span class="dv">5</span>)
<span class="co">#&gt; # A tibble: 5 x 9</span>
<span class="co">#&gt;   school_id class_id date       school_start        school_end         </span>
<span class="co">#&gt;       &lt;int&gt;    &lt;int&gt; &lt;date&gt;     &lt;dttm&gt;              &lt;dttm&gt;             </span>
<span class="co">#&gt; 1         2        2 2013-06-10 2013-06-10 08:45:00 2013-06-10 15:15:00</span>
<span class="co">#&gt; 2         2        2 2013-06-11 2013-06-11 08:45:00 2013-06-11 15:15:00</span>
<span class="co">#&gt; 3         2        2 2013-06-12 2013-06-12 08:45:00 2013-06-12 15:15:00</span>
<span class="co">#&gt; 4         2        2 2013-06-13 2013-06-13 08:45:00 2013-06-13 15:15:00</span>
<span class="co">#&gt; 5         2        2 2013-06-14 2013-06-14 08:45:00 2013-06-14 15:15:00</span>
<span class="co">#&gt; # ... with 4 more variables: recess1_start &lt;dttm&gt;, recess1_end &lt;dttm&gt;,</span>
<span class="co">#&gt; #   recess2_start &lt;dttm&gt;, recess2_end &lt;dttm&gt;</span></code></pre></div>
</div>
<div id="creating-the-five-field-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-the-five-field-tables" class="anchor"></a>Creating the five field tables</h2>
<p>All formulas for building <code>palmsplus</code>, <code>days</code>, <code>trajectories</code>, and <code>multimodal</code> are created. This is done by creating the five field tables:</p>
<ul>
<li><code>palmsplus_fields</code></li>
<li><code>palmsplus_domains</code></li>
<li><code>trajectory_fields</code></li>
<li><code>trajectory_locations</code></li>
<li><code>multimodal_fields</code></li>
</ul>
<p>Most of these tables can be populated using the <code><a href="../reference/palms_load_defaults.html">palms_load_defaults()</a></code>. I use this function as a base, but then add additional fields that are specific to my dataset and research questions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Remove all field tables that exist</span>
<span class="kw"><a href="../reference/palms_remove_tables.html">palms_remove_tables</a></span>()

<span class="co"># load defaults for:</span>
<span class="co"># * palmsplus_fields</span>
<span class="co"># * trajectory_fields</span>
<span class="co"># * multimodal_fields</span>
<span class="kw"><a href="../reference/palms_load_defaults.html">palms_load_defaults</a></span>(<span class="kw"><a href="../reference/palms_epoch.html">palms_epoch</a></span>(palms))

<span class="co"># palmsplus_fields (from other files)</span>
<span class="kw"><a href="../reference/palms_add_field.html">palms_add_field</a></span>(<span class="st">"in_school_time"</span>, <span class="st">"palms_in_time(., i, class_timetable, participant_basis, school_start, school_end)"</span>)
<span class="kw"><a href="../reference/palms_add_field.html">palms_add_field</a></span>(<span class="st">"in_recess1"</span>, <span class="st">"palms_in_time(., i, class_timetable, participant_basis, recess1_start, recess1_end)"</span>)
<span class="kw"><a href="../reference/palms_add_field.html">palms_add_field</a></span>(<span class="st">"in_recess2"</span>, <span class="st">"palms_in_time(., i, class_timetable, participant_basis, recess2_start, recess2_end)"</span>)
<span class="kw"><a href="../reference/palms_add_field.html">palms_add_field</a></span>(<span class="st">"at_home"</span>, <span class="st">"palms_in_polygon(., filter(home.buffer, identifier == i), identifier)"</span>)
<span class="kw"><a href="../reference/palms_add_field.html">palms_add_field</a></span>(<span class="st">"at_school"</span>, <span class="st">"palms_in_polygon(., filter(school, school_id == participant_basis %&gt;% filter(identifier == i) %&gt;% pull(school_id)))"</span>)

<span class="co"># palmsplus_domains</span>
<span class="kw"><a href="../reference/palms_add_domain.html">palms_add_domain</a></span>(<span class="st">"home"</span>, <span class="st">"at_home"</span>)
<span class="kw"><a href="../reference/palms_add_domain.html">palms_add_domain</a></span>(<span class="st">"school"</span>, <span class="st">"(!at_home &amp; at_school &amp; in_school_time)"</span>)
<span class="kw"><a href="../reference/palms_add_domain.html">palms_add_domain</a></span>(<span class="st">"transport"</span>, <span class="st">"!at_home &amp; !(at_school &amp; in_school_time) &amp; (pedestrian | bicycle | vehicle)"</span>)
<span class="kw"><a href="../reference/palms_add_domain.html">palms_add_domain</a></span>(<span class="st">"leisure"</span>, <span class="st">"!at_home &amp; !(at_school &amp; in_school_time) &amp; !pedestrian &amp; !bicycle &amp; !vehicle"</span>)

<span class="co"># trajectory_locations</span>
<span class="kw"><a href="../reference/palms_add_trajectory_location.html">palms_add_trajectory_location</a></span>(<span class="st">"home_school"</span>, <span class="st">"at_home"</span>, <span class="st">"at_school"</span>)
<span class="kw"><a href="../reference/palms_add_trajectory_location.html">palms_add_trajectory_location</a></span>(<span class="st">"school_home"</span>, <span class="st">"at_school"</span>, <span class="st">"at_home"</span>)
<span class="kw"><a href="../reference/palms_add_trajectory_location.html">palms_add_trajectory_location</a></span>(<span class="st">"home_home"</span>, <span class="st">"at_home"</span>, <span class="st">"at_home"</span>)
<span class="kw"><a href="../reference/palms_add_trajectory_location.html">palms_add_trajectory_location</a></span>(<span class="st">"school_school"</span>, <span class="st">"at_school"</span>, <span class="st">"at_school"</span>)</code></pre></div>
<p>I didn’t specify any additional <code>trajectory_fields</code> or <code>multimodal_fields</code> as the default fields will suffice. All five of the field tables look like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">palmsplus_fields</code></pre></div>
<table class="table">
<caption>palmsplus_fields</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">formula</th>
<th align="left">domain_field</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">weekday</td>
<td align="left">dow &lt; 6</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">weekend</td>
<td align="left">dow &gt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">indoors</td>
<td align="left">iov == 3</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">outdoors</td>
<td align="left">iov == 1</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">in_vehicle</td>
<td align="left">iov == 2</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">inserted</td>
<td align="left">fixtypecode == 6</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">pedestrian</td>
<td align="left">tripmot == 1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">bicycle</td>
<td align="left">tripmot == 2</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">vehicle</td>
<td align="left">tripmot == 3</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">nonwear</td>
<td align="left">activityintensity &lt; 0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">wear</td>
<td align="left">activityintensity &gt;= 0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">sedentary</td>
<td align="left">activityintensity == 0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">light</td>
<td align="left">activityintensity == 1</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">moderate</td>
<td align="left">activityintensity == 2</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">vigorous</td>
<td align="left">activityintensity == 3</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mvpa</td>
<td align="left">moderate + vigorous</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">in_school_time</td>
<td align="left">palms_in_time(., i, class_timetable, participant_basis, school_start, school_end)</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">in_recess1</td>
<td align="left">palms_in_time(., i, class_timetable, participant_basis, recess1_start, recess1_end)</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">in_recess2</td>
<td align="left">palms_in_time(., i, class_timetable, participant_basis, recess2_start, recess2_end)</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">at_home</td>
<td align="left">palms_in_polygon(., filter(home.buffer, identifier == i), identifier)</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">at_school</td>
<td align="left">palms_in_polygon(., filter(school, school_id == participant_basis %&gt;% filter(identifier == i) %&gt;% pull(school_id)))</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">palmsplus_domains</code></pre></div>
<table class="table">
<caption>palmsplus_domains</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">home</td>
<td align="left">at_home</td>
</tr>
<tr class="even">
<td align="left">school</td>
<td align="left">(!at_home &amp; at_school &amp; in_school_time)</td>
</tr>
<tr class="odd">
<td align="left">transport</td>
<td align="left">!at_home &amp; !(at_school &amp; in_school_time) &amp; (pedestrian | bicycle | vehicle)</td>
</tr>
<tr class="even">
<td align="left">leisure</td>
<td align="left">!at_home &amp; !(at_school &amp; in_school_time) &amp; !pedestrian &amp; !bicycle &amp; !vehicle</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trajectory_fields</code></pre></div>
<table class="table">
<caption>trajectory_fields</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">formula</th>
<th align="left">after_conversion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mot</td>
<td align="left">first(tripmot)</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">first(as.Date(datetime))</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">start</td>
<td align="left">datetime[triptype==1]</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">end</td>
<td align="left">datetime[triptype==4]</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">duration</td>
<td align="left">as.numeric(difftime(end, start, units = “secs”) + 15)</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">nonwear</td>
<td align="left">sum(activityintensity &lt; 0) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">wear</td>
<td align="left">sum(activityintensity &gt;= 0) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">sedentary</td>
<td align="left">sum(activityintensity == 0) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">light</td>
<td align="left">sum(activityintensity == 1) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">moderate</td>
<td align="left">sum(activityintensity == 2) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">vigorous</td>
<td align="left">sum(activityintensity == 3) * 15</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mvpa</td>
<td align="left">moderate + vigorous</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">length</td>
<td align="left">as.numeric(st_length(.))</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">speed</td>
<td align="left">(length / duration) * 3.6</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trajectory_locations</code></pre></div>
<table class="table">
<caption>trajectory_locations</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">start_criteria</th>
<th align="left">end_criteria</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">home_school</td>
<td align="left">at_home</td>
<td align="left">at_school</td>
</tr>
<tr class="even">
<td align="left">school_home</td>
<td align="left">at_school</td>
<td align="left">at_home</td>
</tr>
<tr class="odd">
<td align="left">home_home</td>
<td align="left">at_home</td>
<td align="left">at_home</td>
</tr>
<tr class="even">
<td align="left">school_school</td>
<td align="left">at_school</td>
<td align="left">at_school</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multimodal_fields</code></pre></div>
<table class="table">
<caption>multimodal_fields</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">func</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">duration</td>
<td align="left">sum</td>
</tr>
<tr class="even">
<td align="left">nonwear</td>
<td align="left">sum</td>
</tr>
<tr class="odd">
<td align="left">wear</td>
<td align="left">sum</td>
</tr>
<tr class="even">
<td align="left">sedentary</td>
<td align="left">sum</td>
</tr>
<tr class="odd">
<td align="left">light</td>
<td align="left">sum</td>
</tr>
<tr class="even">
<td align="left">moderate</td>
<td align="left">sum</td>
</tr>
<tr class="odd">
<td align="left">vigorous</td>
<td align="left">sum</td>
</tr>
<tr class="even">
<td align="left">mvpa</td>
<td align="left">sum</td>
</tr>
<tr class="odd">
<td align="left">length</td>
<td align="left">sum</td>
</tr>
<tr class="even">
<td align="left">speed</td>
<td align="left">mean</td>
</tr>
</tbody>
</table>
</div>
<div id="build-palmsplus-days-trajectories-and-multimodal" class="section level2">
<h2 class="hasAnchor">
<a href="#build-palmsplus-days-trajectories-and-multimodal" class="anchor"></a>Build palmsplus, days, trajectories, and multimodal</h2>
<p>Once all of the formula tables are created, it is simple to build all of the datasets. I’ve included a timer here to see how long it takes to process:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Start the timer</span>
t &lt;-<span class="st"> </span><span class="kw">proc.time</span>()

<span class="co"># Build palmsplus</span>
palmsplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/palms_build_palmsplus.html">palms_build_palmsplus</a></span>(palms)
<span class="co">#&gt; [1/191] Computed palmsplus for: RC0430</span>
<span class="co">#&gt; [2/191] Computed palmsplus for: RC0495</span>
<span class="co">#&gt; [3/191] Computed palmsplus for: RC0404</span>
<span class="co">#&gt; [4/191] Computed palmsplus for: RC0475</span>
<span class="co">#&gt; [5/191] Computed palmsplus for: RC0488</span>
<span class="co">#&gt; [6/191] Computed palmsplus for: RC0507</span>
<span class="co">#&gt; [7/191] Computed palmsplus for: RC0456</span>
<span class="co">#&gt; [8/191] Computed palmsplus for: RC0515</span>
<span class="co">#&gt; [9/191] Computed palmsplus for: RC0509</span>
<span class="co">#&gt; [10/191] Computed palmsplus for: RC0494</span>
<span class="co">#&gt; [11/191] Computed palmsplus for: RC0400</span>
<span class="co">#&gt; [12/191] Computed palmsplus for: RC0422</span>
<span class="co">#&gt; [13/191] Computed palmsplus for: RC0423</span>
<span class="co">#&gt; [14/191] Computed palmsplus for: RC0506</span>
<span class="co">#&gt; [15/191] Computed palmsplus for: RC0439</span>
<span class="co">#&gt; [16/191] Computed palmsplus for: RC0445</span>
<span class="co">#&gt; [17/191] Computed palmsplus for: RC0465</span>
<span class="co">#&gt; [18/191] Computed palmsplus for: RC0476</span>
<span class="co">#&gt; [19/191] Computed palmsplus for: RC0470</span>
<span class="co">#&gt; [20/191] Computed palmsplus for: RC0478</span>
<span class="co">#&gt; [21/191] Computed palmsplus for: RC0420</span>
<span class="co">#&gt; [22/191] Computed palmsplus for: RC0437</span>
<span class="co">#&gt; [23/191] Computed palmsplus for: RC0415</span>
<span class="co">#&gt; [24/191] Computed palmsplus for: RC0510</span>
<span class="co">#&gt; [25/191] Computed palmsplus for: RC0520</span>
<span class="co">#&gt; [26/191] Computed palmsplus for: RC0466</span>
<span class="co">#&gt; [27/191] Computed palmsplus for: RC0414</span>
<span class="co">#&gt; [28/191] Computed palmsplus for: RC0406</span>
<span class="co">#&gt; [29/191] Computed palmsplus for: BC0608</span>
<span class="co">#&gt; [30/191] Computed palmsplus for: BC0626</span>
<span class="co">#&gt; [31/191] Computed palmsplus for: BC0627</span>
<span class="co">#&gt; [32/191] Computed palmsplus for: BC0629</span>
<span class="co">#&gt; [33/191] Computed palmsplus for: BC0632</span>
<span class="co">#&gt; [34/191] Computed palmsplus for: BC0668</span>
<span class="co">#&gt; [35/191] Computed palmsplus for: BC0670</span>
<span class="co">#&gt; [36/191] Computed palmsplus for: BC0676</span>
<span class="co">#&gt; [37/191] Computed palmsplus for: BC0684</span>
<span class="co">#&gt; [38/191] Computed palmsplus for: BC0710</span>
<span class="co">#&gt; [39/191] Computed palmsplus for: BC0733</span>
<span class="co">#&gt; [40/191] Computed palmsplus for: BC0750</span>
<span class="co">#&gt; [41/191] Computed palmsplus for: BC0771</span>
<span class="co">#&gt; [42/191] Computed palmsplus for: BC0828</span>
<span class="co">#&gt; [43/191] Computed palmsplus for: BC0838</span>
<span class="co">#&gt; [44/191] Computed palmsplus for: BC0912</span>
<span class="co">#&gt; [45/191] Computed palmsplus for: BC0938</span>
<span class="co">#&gt; [46/191] Computed palmsplus for: BC0948</span>
<span class="co">#&gt; [47/191] Computed palmsplus for: BC1005</span>
<span class="co">#&gt; [48/191] Computed palmsplus for: BC1012</span>
<span class="co">#&gt; [49/191] Computed palmsplus for: BC1177</span>
<span class="co">#&gt; [50/191] Computed palmsplus for: BC1212</span>
<span class="co">#&gt; [51/191] Computed palmsplus for: BC1215</span>
<span class="co">#&gt; [52/191] Computed palmsplus for: BC1227</span>
<span class="co">#&gt; [53/191] Computed palmsplus for: BC1252</span>
<span class="co">#&gt; [54/191] Computed palmsplus for: BC1255</span>
<span class="co">#&gt; [55/191] Computed palmsplus for: BC1268</span>
<span class="co">#&gt; [56/191] Computed palmsplus for: BC1305</span>
<span class="co">#&gt; [57/191] Computed palmsplus for: HC1904</span>
<span class="co">#&gt; [58/191] Computed palmsplus for: HC1906</span>
<span class="co">#&gt; [59/191] Computed palmsplus for: HC1907</span>
<span class="co">#&gt; [60/191] Computed palmsplus for: HC1909</span>
<span class="co">#&gt; [61/191] Computed palmsplus for: HC1911</span>
<span class="co">#&gt; [62/191] Computed palmsplus for: HC1916</span>
<span class="co">#&gt; [63/191] Computed palmsplus for: HC1917</span>
<span class="co">#&gt; [64/191] Computed palmsplus for: HC1918</span>
<span class="co">#&gt; [65/191] Computed palmsplus for: HC1924</span>
<span class="co">#&gt; [66/191] Computed palmsplus for: HC1925</span>
<span class="co">#&gt; [67/191] Computed palmsplus for: HC1927</span>
<span class="co">#&gt; [68/191] Computed palmsplus for: HC1936</span>
<span class="co">#&gt; [69/191] Computed palmsplus for: HC1939</span>
<span class="co">#&gt; [70/191] Computed palmsplus for: HC1944</span>
<span class="co">#&gt; [71/191] Computed palmsplus for: HC1948</span>
<span class="co">#&gt; [72/191] Computed palmsplus for: HC1952</span>
<span class="co">#&gt; [73/191] Computed palmsplus for: HC1954</span>
<span class="co">#&gt; [74/191] Computed palmsplus for: HC1961</span>
<span class="co">#&gt; [75/191] Computed palmsplus for: HC1962</span>
<span class="co">#&gt; [76/191] Computed palmsplus for: HC1963</span>
<span class="co">#&gt; [77/191] Computed palmsplus for: HC1968</span>
<span class="co">#&gt; [78/191] Computed palmsplus for: HC1970</span>
<span class="co">#&gt; [79/191] Computed palmsplus for: HC1971</span>
<span class="co">#&gt; [80/191] Computed palmsplus for: HC1976</span>
<span class="co">#&gt; [81/191] Computed palmsplus for: HC1979</span>
<span class="co">#&gt; [82/191] Computed palmsplus for: HC1980</span>
<span class="co">#&gt; [83/191] Computed palmsplus for: OC1402</span>
<span class="co">#&gt; [84/191] Computed palmsplus for: OC1403</span>
<span class="co">#&gt; [85/191] Computed palmsplus for: OC1404</span>
<span class="co">#&gt; [86/191] Computed palmsplus for: OC1413</span>
<span class="co">#&gt; [87/191] Computed palmsplus for: OC1414</span>
<span class="co">#&gt; [88/191] Computed palmsplus for: OC1421</span>
<span class="co">#&gt; [89/191] Computed palmsplus for: OC1429</span>
<span class="co">#&gt; [90/191] Computed palmsplus for: OC1439</span>
<span class="co">#&gt; [91/191] Computed palmsplus for: OC1442</span>
<span class="co">#&gt; [92/191] Computed palmsplus for: OC1443</span>
<span class="co">#&gt; [93/191] Computed palmsplus for: OC1444</span>
<span class="co">#&gt; [94/191] Computed palmsplus for: OC1450</span>
<span class="co">#&gt; [95/191] Computed palmsplus for: OC1451</span>
<span class="co">#&gt; [96/191] Computed palmsplus for: OC1454</span>
<span class="co">#&gt; [97/191] Computed palmsplus for: OC1461</span>
<span class="co">#&gt; [98/191] Computed palmsplus for: OC1466</span>
<span class="co">#&gt; [99/191] Computed palmsplus for: OC1467</span>
<span class="co">#&gt; [100/191] Computed palmsplus for: OC1468</span>
<span class="co">#&gt; [101/191] Computed palmsplus for: OC1473</span>
<span class="co">#&gt; [102/191] Computed palmsplus for: OC1476</span>
<span class="co">#&gt; [103/191] Computed palmsplus for: OC1479</span>
<span class="co">#&gt; [104/191] Computed palmsplus for: OC1480</span>
<span class="co">#&gt; [105/191] Computed palmsplus for: OC1484</span>
<span class="co">#&gt; [106/191] Computed palmsplus for: OC1485</span>
<span class="co">#&gt; [107/191] Computed palmsplus for: OC1489</span>
<span class="co">#&gt; [108/191] Computed palmsplus for: OC1501</span>
<span class="co">#&gt; [109/191] Computed palmsplus for: OC1503</span>
<span class="co">#&gt; [110/191] Computed palmsplus for: OC1507</span>
<span class="co">#&gt; [111/191] Computed palmsplus for: PH1800</span>
<span class="co">#&gt; [112/191] Computed palmsplus for: PH1801</span>
<span class="co">#&gt; [113/191] Computed palmsplus for: PH1803</span>
<span class="co">#&gt; [114/191] Computed palmsplus for: PH1805</span>
<span class="co">#&gt; [115/191] Computed palmsplus for: PH1806</span>
<span class="co">#&gt; [116/191] Computed palmsplus for: PH1807</span>
<span class="co">#&gt; [117/191] Computed palmsplus for: PH1808</span>
<span class="co">#&gt; [118/191] Computed palmsplus for: PH1809</span>
<span class="co">#&gt; [119/191] Computed palmsplus for: PH1810</span>
<span class="co">#&gt; [120/191] Computed palmsplus for: PH1813</span>
<span class="co">#&gt; [121/191] Computed palmsplus for: PH1814</span>
<span class="co">#&gt; [122/191] Computed palmsplus for: PH1817</span>
<span class="co">#&gt; [123/191] Computed palmsplus for: PH1818</span>
<span class="co">#&gt; [124/191] Computed palmsplus for: PH1820</span>
<span class="co">#&gt; [125/191] Computed palmsplus for: PH1823</span>
<span class="co">#&gt; [126/191] Computed palmsplus for: PH1824</span>
<span class="co">#&gt; [127/191] Computed palmsplus for: PH1825</span>
<span class="co">#&gt; [128/191] Computed palmsplus for: PH1826</span>
<span class="co">#&gt; [129/191] Computed palmsplus for: PH1827</span>
<span class="co">#&gt; [130/191] Computed palmsplus for: PH1828</span>
<span class="co">#&gt; [131/191] Computed palmsplus for: PH1829</span>
<span class="co">#&gt; [132/191] Computed palmsplus for: PH1830</span>
<span class="co">#&gt; [133/191] Computed palmsplus for: RT1607</span>
<span class="co">#&gt; [134/191] Computed palmsplus for: PH1832</span>
<span class="co">#&gt; [135/191] Computed palmsplus for: PH1835</span>
<span class="co">#&gt; [136/191] Computed palmsplus for: RT1608</span>
<span class="co">#&gt; [137/191] Computed palmsplus for: RT1611</span>
<span class="co">#&gt; [138/191] Computed palmsplus for: RT1617</span>
<span class="co">#&gt; [139/191] Computed palmsplus for: RT1620</span>
<span class="co">#&gt; [140/191] Computed palmsplus for: RT1622</span>
<span class="co">#&gt; [141/191] Computed palmsplus for: RT1625</span>
<span class="co">#&gt; [142/191] Computed palmsplus for: RT1632</span>
<span class="co">#&gt; [143/191] Computed palmsplus for: RT1634</span>
<span class="co">#&gt; [144/191] Computed palmsplus for: RT1636</span>
<span class="co">#&gt; [145/191] Computed palmsplus for: RT1637</span>
<span class="co">#&gt; [146/191] Computed palmsplus for: RT1645</span>
<span class="co">#&gt; [147/191] Computed palmsplus for: RT1647</span>
<span class="co">#&gt; [148/191] Computed palmsplus for: RT1649</span>
<span class="co">#&gt; [149/191] Computed palmsplus for: RT1657</span>
<span class="co">#&gt; [150/191] Computed palmsplus for: RT1658</span>
<span class="co">#&gt; [151/191] Computed palmsplus for: RT1663</span>
<span class="co">#&gt; [152/191] Computed palmsplus for: RT1665</span>
<span class="co">#&gt; [153/191] Computed palmsplus for: RT1666</span>
<span class="co">#&gt; [154/191] Computed palmsplus for: RT1668</span>
<span class="co">#&gt; [155/191] Computed palmsplus for: RT1669</span>
<span class="co">#&gt; [156/191] Computed palmsplus for: RT1671</span>
<span class="co">#&gt; [157/191] Computed palmsplus for: RT1672</span>
<span class="co">#&gt; [158/191] Computed palmsplus for: RT1673</span>
<span class="co">#&gt; [159/191] Computed palmsplus for: RT1674</span>
<span class="co">#&gt; [160/191] Computed palmsplus for: RT1677</span>
<span class="co">#&gt; [161/191] Computed palmsplus for: RT1678</span>
<span class="co">#&gt; [162/191] Computed palmsplus for: RT1680</span>
<span class="co">#&gt; [163/191] Computed palmsplus for: WH1700</span>
<span class="co">#&gt; [164/191] Computed palmsplus for: WH1701</span>
<span class="co">#&gt; [165/191] Computed palmsplus for: WH1702</span>
<span class="co">#&gt; [166/191] Computed palmsplus for: WH1703</span>
<span class="co">#&gt; [167/191] Computed palmsplus for: WH1713</span>
<span class="co">#&gt; [168/191] Computed palmsplus for: WH1714</span>
<span class="co">#&gt; [169/191] Computed palmsplus for: WH1715</span>
<span class="co">#&gt; [170/191] Computed palmsplus for: WH1718</span>
<span class="co">#&gt; [171/191] Computed palmsplus for: WH1720</span>
<span class="co">#&gt; [172/191] Computed palmsplus for: WH1719</span>
<span class="co">#&gt; [173/191] Computed palmsplus for: WH1721</span>
<span class="co">#&gt; [174/191] Computed palmsplus for: WH1722</span>
<span class="co">#&gt; [175/191] Computed palmsplus for: WH1731</span>
<span class="co">#&gt; [176/191] Computed palmsplus for: WH1732</span>
<span class="co">#&gt; [177/191] Computed palmsplus for: WH1734</span>
<span class="co">#&gt; [178/191] Computed palmsplus for: WH1733</span>
<span class="co">#&gt; [179/191] Computed palmsplus for: WH1744</span>
<span class="co">#&gt; [180/191] Computed palmsplus for: WH1745</span>
<span class="co">#&gt; [181/191] Computed palmsplus for: WH1746</span>
<span class="co">#&gt; [182/191] Computed palmsplus for: WH1747</span>
<span class="co">#&gt; [183/191] Computed palmsplus for: WH1757</span>
<span class="co">#&gt; [184/191] Computed palmsplus for: WH1758</span>
<span class="co">#&gt; [185/191] Computed palmsplus for: WH1759</span>
<span class="co">#&gt; [186/191] Computed palmsplus for: WH1762</span>
<span class="co">#&gt; [187/191] Computed palmsplus for: WH1768</span>
<span class="co">#&gt; [188/191] Computed palmsplus for: WH1769</span>
<span class="co">#&gt; [189/191] Computed palmsplus for: WH1770</span>
<span class="co">#&gt; [190/191] Computed palmsplus for: WH1771</span>
<span class="co">#&gt; [191/191] Computed palmsplus for: WH1784</span>

<span class="co"># Build days</span>
days &lt;-<span class="st"> </span><span class="kw"><a href="../reference/palms_build_days.html">palms_build_days</a></span>(palmsplus)

<span class="co"># Build trajectories</span>
trajectories &lt;-<span class="st"> </span><span class="kw"><a href="../reference/palms_build_trajectories.html">palms_build_trajectories</a></span>(palmsplus)

<span class="co"># Build multimodal trips</span>
multimodal &lt;-<span class="st"> </span><span class="kw"><a href="../reference/palms_build_multimodal.html">palms_build_multimodal</a></span>(trajectories, <span class="dv">200</span>, <span class="dv">10</span>)
<span class="co">#&gt; Calculating multimodal eligibility...done</span>
<span class="co">#&gt; Assigning trip numbers...done</span>
<span class="co">#&gt; Calculating fields...done</span>

<span class="kw">cat</span>(<span class="st">"Run time:"</span>, (<span class="kw">proc.time</span>() <span class="op">-</span><span class="st"> </span>t)[[<span class="dv">1</span>]]<span class="op">/</span><span class="dv">60</span>, <span class="st">"minutes"</span>)
<span class="co">#&gt; Run time: 19.14683 minutes</span></code></pre></div>
<p>Just over 15 minutes for 191 participants isn’t to bad!</p>
</div>
<div id="saving-results" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-results" class="anchor"></a>Saving results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(palmsplus, <span class="st">"palmsplus.csv"</span>)
<span class="kw">write_csv</span>(days, <span class="st">"days.csv"</span>)
<span class="kw">write_csv</span>(trajectories, <span class="st">"trajectories.csv"</span>)
<span class="kw">write_csv</span>(trajectories, <span class="st">"multimodal.csv"</span>)

<span class="kw">st_write</span>(palmsplus, <span class="st">"palmsplus.shp"</span>)
<span class="kw">st_write</span>(trajectories, <span class="st">"trajecories.shp"</span>)
<span class="kw">st_write</span>(trajectories, <span class="st">"multimodal.shp"</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#reading-data">Reading data</a></li>
      <li><a href="#creating-the-five-field-tables">Creating the five field tables</a></li>
      <li><a href="#build-palmsplus-days-trajectories-and-multimodal">Build palmsplus, days, trajectories, and multimodal</a></li>
      <li><a href="#saving-results">Saving results</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Tom Stewart.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
